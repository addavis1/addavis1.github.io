<!DOCTYPE html>
<html lang="en-US"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Centering Test</title>
<style>


.bigtext {font:bold 20px serif; fill:white;}
.smalltext {font:bold 16px serif; fill:black;}
.smalltextred {font:normal 14px serif; fill:red;}
.button {background-color: #0000FF; border:2px solid yellow; border-radius: 8px; color:yellow; padding:4px; text-align:center; font-size:20px;}
.fixedWidth {display:inline-block; width:130px;}

html, body { margin: 0; padding: 0; height: 100%; }
#container {  display: grid;
              grid-template-areas: "a b c";
              grid-template-columns: 1fr auto 1fr;              
              height: 100%;
              background-color: lightgreen;
            }
#container > div:nth-child(1) { grid-area: a; background-color: violet; }
#container > div:nth-child(2) { grid-area: b; align-self: center; background-color: pink; }
#container > div:nth-child(3) { grid-area: c; background-color: lightblue; }
svg { display: block; margin: 0 auto; padding: 0; }

#questionBox { display: none; }

</style>


<script type='text/javascript'>
//window.onresize = location.reload();

function svgResize(svgObj) {
  let w = window.innerWidth;
  let h = window.innerHeight;
  let svgW = svgObj.width.baseVal.valueInSpecifiedUnits;
  let svgH = svgObj.height.baseVal.valueInSpecifiedUnits;
  let svgCon = document.getElementById('svgContainer');
  
  let W,H;
  
  
  if( svgW/svgH < w/h ) { // svg aspect ratio is more taller than window
    W = h*svgW/svgH;
    H = h;
  } else if ( svgW/svgH >= w/h ) { // svg aspect ratio is shorter than window
    W = w;
    H = w*svgH/svgW;
  }
  svgObj.setAttribute('width',W);  
  svgObj.setAttribute('height',H);
  svgCon.style.width=W+'px';
  svgCon.style.height=H+'px';
}
</script>

<script type='text/javascript'>
// each question is a javascript object
function loadQuestion(q) {
	let questionBox = document.getElementById('questionBox');
	let questionBoxText = document.getElementById('questionBoxText');
	
	if ( typeof(q) == 'object' ) { // load the question popup
		if( (questionBox.style.display == '' || questionBox.style.display == 'none') ||	 q.id != currentQuestionId ) { questionBox.style.display = 'block'; }
		else { questionBox.style.display = 'none'; }
		questionBoxText.innerHTML = q.qText;
		
		currentQuestionId = q.id; 
	}
	else { questionBox.style.display = 'none'; }

}

let currentQuestionId = '';

let question1 = { 
	id:'question1',
	qText:"This is some question text.",
	qAnswer:"This is the answer."
}

let question2 = {
	id:'question2',
	qText:"This is some <b>different</b> question text.",
	qAnswer:"This is the answer to question 2."
}


</script>

</head>

<body>
<div id='container'>
<div></div>
<div id='svgContainer'>
<svg id='svgObject' style="position:relative; left:0px; top:0px; background-color:rgb(0,0,0)" onload='svgResize(this,this.width,this.height);' width="800" height="400" viewBox="0 0 800 400">




  <g id="rep1" x="0" y="0" width="400" height="400">
  <svg>
  <line x1="25" y1="25" x2="25" y2="375" stroke="white" stroke-width="2"></line>
  <line x1="25" y1="200" x2="375" y2="200" stroke="white" stroke-width="2"></line>
  <text class="bigtext" x="10" y="250" fill="white" transform="rotate(-90,0,0) translate(-275,-233)">Radial Velocity (m/s)</text>
  <text class="bigtext" x="150" y="385">Time (years)</text>
  <path id="rvcurve" stroke="yellow" opacity=0.75 stroke-width="2" fill="none" d=""></path>
  
  <circle id="point" cx="115.41666666666667" cy="70.05898351064354" r="10" fill="url('#limbDarkening')" stroke="none"></circle>
  <circle id="point2" cx="115.41666666666667" cy="70.05898351064354" r="15" fill="yellow" opacity="0.2" stroke="none"></circle>   
  
  <!-- Draw Arrow  -->
  <path id="arrow" stoke="none" fill="lime" d="M 250,150 l 21 -28 v 14 h 70 v 28 h -70 v 14 l -21 -28 z"></path>
  <text class="smalltext" x="260" y="155">to observer</text>
  </svg>
  </g>

<g id="rep2" transform="translate(400,0)"> 
<svg>
    <!--  Draw Center of Mass Cross  -->
    <g stroke="green" stroke-width="2">
		 <line x1="195" y1="200" x2="205" y2="200"></line>
		 <line x1="200" y1="195" x2="200" y2="205"></line>
	</g>
	<!-- Draw Orbits    -->
	<circle id="StarOrbit" cx="200" cy="200" r="30" fill="none" stroke-width="1" stroke="lightgray"></circle>  
	<circle id="PlanOrbit" cx="200" cy="200" r="180" fill="none" stroke-width="1" stroke="lightgray"></circle> 
    <!-- Draw Star-->
	<g>
	   <svg id="Star" x="1.570078687288319" y="29.958886042637214" onclick='loadQuestion(question2);'>
	        <circle id="StarGlow" cx="200" cy="200" r="15" fill="yellow" opacity="0.3" stroke="none"></circle>   
            <circle id="StarDisc" cx="200" cy="200" r="10" fill="url('#limbDarkening')" stroke="none"></circle>   
          <defs>
              <radialGradient id="limbDarkening">
                  <stop offset="10%" stop-color="yellow"></stop>
                  <stop offset="95%" stop-color="goldenrod"></stop>
              </radialGradient>
          </defs>
	    </svg>
	 </g>
	 <!-- Draw Planet-->
	 <g>
	    <svg id="Planet" x="-9.420472123729851" y="-179.75331625582328" onclick='loadQuestion(question1);'>
	      <circle cx="200" cy="200" r="10" fill="olivedrab" stroke="none"></circle>   
		  <circle cx="200" cy="200" r="8" fill="yellowgreen" stroke="none"></circle>  
		  <circle cx="200" cy="200" r="6" fill="olivedrab" stroke="none"></circle>   
		  <circle cx="200" cy="200" r="2" fill="moccasin" stroke="none"></circle> 
        </svg>		  
	 </g>
	 <!-- Button for Animate/Stop Toggle  -->
	 <g id="button">
	      <rect x="330" y="360" width="60" height="30" rx="10" ry="10" fill="rgb(0,0,255)" stroke="red" stroke-width="2"></rect>
	      <text id="blabel" class="bigprint" x="330" y="380" fill="white" xml:space="preserve">Animate</text>
     </g>
	 
</svg></g>

	<g id='questionBox'>
	<rect x='20' y='20' width='400' height='160' fill='white'/>
	<foreignObject x="20" y="20" width="400" height="160" >
    <!--
      In the context of SVG embedded in an HTML document, the XHTML 
      namespace could be omitted, but it is mandatory in the 
      context of an SVG document
    -->
    <div xmlns="http://www.w3.org/1999/xhtml" id='questionBoxText'>Question Text</div>
	</foreignObject>
	</g>

</svg></div>
<div></div>
</div> <!-- end grid container -->

<script type="text/javascript">
  var pointx, pointy; 
	var day = 93;
	var RVamp=130;
	var rate = 360/15000;   // a complete cycle in 15 seconds, in a fake year
	var prevTime = null;
  var requestID = null;
	var point = document.getElementById("point");
  var point2 = document.getElementById("point2");
    var button = document.getElementById("button");
	button.addEventListener("mousedown", toggleAnimation);
    drawStuff(day);
    
  addPath();


function animationCallback(time) {

  if (prevTime !== null) {
    var delta = time - prevTime; 
    day=(day+rate*delta)%360;
  }
  drawStuff(day);
  prevTime = time;
  requestID = window.requestAnimationFrame(animationCallback);
}



function drawStuff(day) {
  let pointx,pointy,starx,stary;
	pointx=25+350*(day/365.0);
	pointy=200-RVamp*Math.sin(2*Math.PI*day/365.0);
	point.setAttribute("cx",pointx);
	point.setAttribute("cy",pointy);
  point2.setAttribute("cx",pointx);
	point2.setAttribute("cy",pointy);

	starx=30*Math.cos((-day+180.0)*Math.PI/180.0); // Make planet orbit ccw
  stary=30*Math.sin((-day+180)*Math.PI/180.0);
  planetx=180*Math.cos(-day*Math.PI/180.0);
  planety=180*Math.sin(-day*Math.PI/180.0);
	Star.setAttribute("x",starx);
	Star.setAttribute("y",stary);
	Planet.setAttribute("x",planetx);
	Planet.setAttribute("y",planety);
}

function toggleAnimation() {

  if (requestID !== null) {
    window.cancelAnimationFrame(requestID);
    requestID = null;
    blabel.textContent="Animate";
	} else {
    requestID = window.requestAnimationFrame(animationCallback);
    prevTime = null;
    blabel.textContent = "   Pause";
  }
}

function addPath() {
  let rvcurve = document.getElementById('rvcurve');
  let i,n,A,x0,y0,x,y,x1,path;
  A = RVamp; x0 = 25, y0 = 200; x1 = 375; n = 200;
  path = 'M '+x0+' '+y0;
  
  for( i = 1; i <= n; i++ ) {
    x = x0+i/n*(x1-x0);
    y = y0-A*Math.sin(i/n*2*Math.PI);
    path += ' L '+x+' '+y;  
  }
  rvcurve.setAttribute('d',path);

}


</script>
	

</body></html>