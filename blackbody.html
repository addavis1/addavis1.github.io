<!doctype html>
<html>
<head>
<title>jsvgplot</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta charset='UTF-8' />
<script src='js/jsvgplot.js'></script>
<script src='js/blackbodycolors.js'></script>
<style type='text/css'>
svg { font-size: 16px; }
</style>   
</head>
<body>
<!--<div style='position: absolute; width: 40vw; height: 40vw; background-color: rgba(0,255,0,0.2);'></div>-->
<svg id='bbsvg' style='border: 1px solid black; width: 80vw; height: 80vh; display: block; margin: 5vh auto; padding: 0px;' onload='bbinit(this.id);'>
<!--<image id='visible_spectrum' x='271.53' y='693' height='30' width='190' href='Linear_visible_spectrum.svg'/> <!-- 380nm to 750nm -->
<script type='text/javascript'>
var coords;
function bbinit(id) {
	coords = new createCoords(id,{'coordsRange':[100,0,2800,14],'clip':true,'margin':['1rem','1.5rem','5rem','8rem']});	
	coords.plotObject('image',{'x1':380,'y1':0,'x2':750,'y2':-0.4,'href':'https://addavis1.github.io/images/Linear_visible_spectrum.svg','append':coords.svg.g2,});
	coords.plotAxis('xy',{'minorNx':4,'minorNy':1,'tickY':1,'tickX':500,'x0':100,'xpts':[100,500,1000,1500,2000,2500],'xaxisLabelsShow':true,'showX0':true},{},{'stroke':'black','stroke-width':5},{});
	coords.plotAxisText('xy',{'xaxis':'wavelength (nm)','yaxis':'intensity / wavelength / steradian (kW/sr/m/m/nm)','xposition':'bottom','xaxisH':0.5,'yaxisV':0.45,'ydu':-30});
	
		drawbbCurve(4000);
}

function blackbody(lambda,param) {
	// B = 2hc^2/lambda^5*1/(e^(h*c/(lambda*kb*T))-1)
	// unis Watts / m^3 / steradian
	lambda = lambda*1E-9;
	let T = param['T'];
	let h = 6.62607015*1E-34; // exact
	let c = 299792458; // exact
	let kb = 1.380649E-23; 	// exact
	let B = 2*h*c*c/Math.pow(lambda,5)/(Math.exp(h*c/(lambda*kb*T))-1);
	B = B/1E12;
	return B;
}

function drawbbCurve(T) {
	id = 'bbsvg';
	let curve = document.getElementById('bbc1');	
	if( curve ) { curve.remove(); }
	
	let index = Math.round((T-1000)/100);
	let color = bbcolors[index][1];
	
	coords.plotFunction(blackbody,{'T':T},{'n':800,'points':false,'x1':1,'z':false,'close':true,'id':'bbc1'},{'stroke':'black','stroke-width':2,'fill':color},{'i0':0,'dn':40},{'stroke':'black','stroke-width':2,'stroke-opacity':1});

}

</script>
</svg>

<input type='range' min='100' max='10000' onchange='drawbbCurve(this.value);'/>


</body>
</html>