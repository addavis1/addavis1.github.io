<!doctype html>
<html>
<head>
<title>Energy</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta charset='UTF-8' />
<script src='js/jsvgplot.js'></script>
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,400;0,900;1,400;1,900&family=Lato:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

<script type='text/javascript'>
var coords;
function energyInit(id) {
	//if ( param == undefined ) { var param = {}; }
	let svg = document.getElementById(id);
	let param = {'coordsRange':[0,0,10,10.5]};	
	coords = new createCoords(id,{'coordsRange':param['coordsRange'],'clip':false,'margin':['3rem','2rem','6rem','2rem']});
	coords.fontSize = 16;	
	let y2 = coords.y0 - coords.rv(coords.fontSize);
	let xpts = [1,3,4,6,7,9];
	coords.plotAxis('x',{'minorNx':0,'grid':false,'xpts':xpts,'xaxisLabelsShow':false,'showX0':true},{},{'stroke':'black','stroke-width':5});
	let textStyle = {'font-size':'4rem','dominant-baseline':'hanging','text-align':'center'};
	
	coords.plotText('KE',{'x':2,'y':-0.25,'append':coords.svg.g2},textStyle);
	coords.plotText('PE',{'x':5,'y':-0.25,'append':coords.svg.g2},textStyle);
	coords.plotText('E',{'x':8,'y':-0.25,'append':coords.svg.g2},textStyle);
	
	plotEnergy();
}

function plotEnergy(E1,ET) {
	let E = ET != undefined ? ET : (document.getElementById('Eval') != undefined ? document.getElementById('Eval').value : 10 );
	let KE,PE;
	if(E1 == 'KE') {
		KE = document.getElementById('KEinput').value*1;
		PE = E - KE;
		document.getElementById('PEinput').value = PE;
	}
	else if (E1 == 'PE') {
		PE = document.getElementById('PEinput').value*1;
		KE = E - PE;
		document.getElementById('KEinput').value = KE;
	} else {
		KE = document.getElementById('KEinput').value*1;
		PE = document.getElementById('PEinput').value*1;
	}
	
	/* remove elements if they exist */	
	if( document.getElementById('KEsvg') != undefined ) { document.getElementById('KEsvg').remove(); }
	if( document.getElementById('PEsvg') != undefined ) { document.getElementById('PEsvg').remove(); }
	if( document.getElementById('E1svg') != undefined ) { document.getElementById('E1svg').remove(); }
	if( document.getElementById('E2svg') != undefined ) { document.getElementById('E2svg').remove(); }
	if( document.getElementById('E3svg') != undefined ) { document.getElementById('E3svg').remove(); }
	if( document.getElementById('KEtext') != undefined ) { document.getElementById('KEtext').remove(); }
	if( document.getElementById('PEtext') != undefined ) { document.getElementById('PEtext').remove(); }
	if( document.getElementById('Etext') != undefined ) { document.getElementById('Etext').remove(); }
	
	/* add elements */
	let textStyle = {'dominant-baseline':'bottom','font-size':'3rem','opacity':0.75};
	KE = (KE*=1).toFixed(2);
	PE = (PE*=1).toFixed(2); 
	E = (E*=1).toFixed(2);
	coords.plotObject('rect',{'x':1,'y':0,'width':2,'height':KE},{'fill':'blue','opacity':0.65,'id':'KEsvg'});
	coords.plotObject('rect',{'x':4,'y':0,'width':2,'height':PE},{'fill':'red','opacity':0.65,'id':'PEsvg'});

	if( document.getElementById('Einput2').checked == true ) {
		coords.plotObject('rect',{'x':7,'y':0,'width':2,'height':KE},{'fill':'blue','opacity':0.65,'id':'E1svg'});
		coords.plotObject('rect',{'x':7,'y':KE*1,'width':2,'height':PE*1},{'fill':'red','opacity':0.65,'id':'E2svg'});
		coords.plotObject('path',{'d':'M 7 '+KE+' h 2'},{'stroke':'black','opacity':0.5,'id':'E3svg'});
	} else {
		coords.plotObject('rect',{'x':7,'y':0,'width':2,'height':E},{'fill':'green','opacity':0.65,'id':'E1svg'});
	}
	
	if( document.getElementById('Einput1').checked == true ) {
		coords.plotText(KE,{'x':2,'y':KE*1,'dy':0.2},Object.assign({'stroke':'blue','id':'KEtext'},textStyle));
		coords.plotText(PE,{'x':5,'y':PE*1,'dy':0.2},Object.assign({'stroke':'red','id':'PEtext'},textStyle));
		coords.plotText(E,{'x':8,'y':E*1,'dy':0.2},Object.assign({'stroke':'black','id':'Etext'},textStyle));
	}

	
	coords.plotObject('line',{'x1':coords.xMin,'x2':coords.xMax,'y1':coords.y0,'y2':coords.y0,'append':coords.svg.g1,'id':'bar-line'},{'stroke':'black','stroke-width':3});
}

</script>

<style type='text/css'>
body { font-family: Chiva; }
svg { font-size: 16px; width: 100%; height: 100vh; position: relative; }
#svgcontainer { position: relative; width: 40vw; margin: 0 auto; }

svg { border: 1px solid black; }

#container { display: grid; grid-template-columns: 1fr 40vw 1fr 20vw 1fr; }
.gridcol { background-color: rgba(0,0,0,0.5); }
#energycontainer { }
#controlscontainer { display: grid; place-content: center; }
#controlscontainer > input { display:block; width: 15vw; margin-bottom: 2rem; }


</style>   
</head>
<body>
<div id='container'>

<div class='gridcol'></div>
<div id='svgcontainer'>
<svg id='energysvg' onload='energyInit(this.id);' viewport='0 0 1000 1000'></svg>
</div>
<div class='gridcol'></div>
<div id='controlscontainer'>
<input type='range' min=0, max=10 id='KEinput' value='5' step='0.01' oninput='plotEnergy("KE");'/>
<input  type='range' min=0, max=10 id='PEinput' value='5' step='0.01' oninput='plotEnergy("PE");'/>
<p><input type='checkbox' id='Einput1' checked onchange='plotEnergy();'/> Show Values</p>
<p><input type='checkbox' id='Einput2' onchange='plotEnergy();'/> Split E Column</p>
<input type='hidden' id='Eval' value='10'/>


</div>
<div class='gridcol'></div>

</div>

</body>
</html>